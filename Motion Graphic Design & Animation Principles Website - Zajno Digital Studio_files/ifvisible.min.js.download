(function(){var e,t;e=this,t=function(){var e,t,i,n,r,u,o,f,s,c,d,a,l,h,v,m;return f={},i=document,c=!1,d="active",u=6e4,r=!1,v={},h="__ceGUID",t={add:function(e,t,i){return e[h]=void 0,e[h]||(e[h]="ifvisible.object.event.identifier"),v[e[h]]||(v[e[h]]={}),v[e[h]][t]||(v[e[h]][t]=[]),v[e[h]][t].push(i)},remove:function(e,t,i){var n,r,u,o,f;if(i){if(e[h]&&v[e[h]]&&v[e[h]][t])for(r=u=0,o=(f=v[e[h]][t]).length;u<o;r=++u)if((n=f[r])===i)return v[e[h]][t].splice(r,1),n}else if(e[h]&&v[e[h]]&&v[e[h]][t])return delete v[e[h]][t]},fire:function(e,t,i){var n,r,u,o,f;if(e[h]&&v[e[h]]&&v[e[h]][t]){for(f=[],r=0,u=(o=v[e[h]][t]).length;r<u;r++)n=o[r],f.push(n(i||{}));return f}}},m=!1,e=function(e,t,i){return m||(m=e.addEventListener?function(e,t,i){return e.addEventListener(t,i,!1)}:e.attachEvent?function(e,t,i){return e.attachEvent("on"+t,i,!1)}:function(e,t,i){return e["on"+t]=i}),m(e,t,i)},o=function(){var e,t,n,r;for(r=3,n=i.createElement("div"),e=n.getElementsByTagName("i"),t=function(){return n.innerHTML="\x3c!--[if gt IE "+ ++r+"]><i></i><![endif]--\x3e",e[0]};t(););return r>4?r:void 0}(),n=!1,l=void 0,void 0!==i.hidden?(n="hidden",l="visibilitychange"):void 0!==i.mozHidden?(n="mozHidden",l="mozvisibilitychange"):void 0!==i.msHidden?(n="msHidden",l="msvisibilitychange"):void 0!==i.webkitHidden&&(n="webkitHidden",l="webkitvisibilitychange"),a=function(){var t,n;return t=!1,(n=function(){return clearTimeout(t),"active"!==d&&f.wakeup(),r=+new Date,t=setTimeout((function(){if("active"===d)return f.idle()}),u)})(),e(i,"mousemove",n),e(i,"keyup",n),e(window,"scroll",n),f.focus(n),f.wakeup(n)},s=function(){var t;return!!c||(!1===n?(t="blur",o<9&&(t="focusout"),e(window,t,(function(){return f.blur()})),e(window,"focus",(function(){return f.focus()}))):e(i,l,(function(){return i[n]?f.blur():f.focus()}),!1),c=!0,a())},f={setIdleDuration:function(e){return u=1e3*e},getIdleDuration:function(){return u},getIdleInfo:function(){var e,t;return e=+new Date,t={},"idle"===d?(t.isIdle=!0,t.idleFor=e-r,t.timeLeft=0,t.timeLeftPer=100):(t.isIdle=!1,t.idleFor=e-r,t.timeLeft=r+u-e,t.timeLeftPer=(100-100*t.timeLeft/u).toFixed(2)),t},focus:function(e){return"function"==typeof e?this.on("focus",e):(d="active",t.fire(this,"focus"),t.fire(this,"wakeup"),t.fire(this,"statusChanged",{status:d})),this},blur:function(e){return"function"==typeof e?this.on("blur",e):(d="hidden",t.fire(this,"blur"),t.fire(this,"idle"),t.fire(this,"statusChanged",{status:d})),this},idle:function(e){return"function"==typeof e?this.on("idle",e):(d="idle",t.fire(this,"idle"),t.fire(this,"statusChanged",{status:d})),this},wakeup:function(e){return"function"==typeof e?this.on("wakeup",e):(d="active",t.fire(this,"wakeup"),t.fire(this,"statusChanged",{status:d})),this},on:function(e,i){return s(),t.add(this,e,i),this},off:function(e,i){return s(),t.remove(this,e,i),this},onEvery:function(e,t){var i,n;return s(),i=!1,t&&(n=setInterval((function(){if("active"===d&&!1===i)return t()}),1e3*e)),{stop:function(){return clearInterval(n)},pause:function(){return i=!0},resume:function(){return i=!1},code:n,callback:t}},now:function(e){return s(),d===(e||"active")}}},"function"==typeof define&&define.amd?define((function(){return t()})):"object"==typeof exports?module.exports=t():e.ifvisible=t()}).call(this);